/* ======= Kopfbereich ======= */
.topbar {
  position: sticky;
  top: 0;
  z-index: 1000; /* Viel höhere Priorität */
  background: var(--paper, #fafafa);
  border-bottom: 1px solid var(--edge, #e5e7eb);
  padding: 10px 16px;
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Leichter Schatten für bessere Abgrenzung */
}
.topbar-left {
  justify-self: start;
}
.topbar-center {
  justify-self: center;
}
.topbar-right {
  justify-self: end;
}

.back-link {
  font-weight: 600;
  text-decoration: none;
  color: var(--link, #0b5);
}
.back-link:hover {
  text-decoration: underline;
}

.page-title {
  margin: 0;
  font-size: clamp(24px, 3.6vw, 38px); /* deutlich größer */
  font-weight: 800;
  text-align: center; /* mittig */
  line-height: 1.2;
}

/* ======= Layout ======= */
.wrap {
  max-width: 1600px;
  margin: 0 auto;
  padding: 1rem;
  padding-bottom: 50vh; /* Platz zum Scrollen am Ende */
  position: relative;
  z-index: 1; /* Niedrigere Priorität als Topbar */
}

.notice.small {
  font-size: 13px;
  color: var(--muted, #666);
  margin-bottom: 12px;
}

.grid-2x2 {
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2 Spalten nebeneinander: links Entwurf, rechts PDF */
  grid-template-rows: 1fr; /* Nur noch 1 Zeile */
  gap: 16px;
  width: 100%;
  min-height: calc(100vh - 120px);
}

/* ======= Paneel ======= */
.pane {
  display: flex;
  flex-direction: column;
  background: var(--card, #fff);
  border: 1px solid var(--edge, #e5e7eb);
  border-radius: 12px;
  overflow: hidden;
  height: 100%;
}

.pane-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid var(--edge, #e5e7eb);
  background: #f9fafb;
  flex-shrink: 0; /* Header soll nicht schrumpfen */
}
.pane-title {
  font-weight: 700;
}
.pane-tools .btn {
  margin-left: 6px;
}

.pane-body {
  flex: 1 1 0; /* Vollständig verfügbaren Platz nutzen */
  min-height: 200px; /* Minimum-Höhe für kleine Fenster */
  overflow-y: auto;
  padding: 12px;
  border: 0;
  background: transparent;
}

/* PDF-Pane speziell - kein grauer Hintergrund */
.pdf-pane .pane-head {
  display: flex !important; /* Stelle sicher, dass der Header sichtbar ist */
  position: relative;
  z-index: 10; /* Über dem PDF-Canvas */
  background: #f9fafb;
}

.pdf-pane .pane-body {
  padding: 0; /* Kein Padding für PDF */
  background: transparent; /* Kein grauer Hintergrund */
  height: 100%; /* Volle Höhe nutzen */
  min-height: 100%; /* Mindesthöhe für vollständige Darstellung */
  overflow: visible; /* Kein Abschneiden */
  position: relative;
}
.pane-body.scroll {
  overflow: auto;
}
.pane-body.mono {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;
  white-space: pre-wrap; /* sorgt für korrekten Zeilenumbruch */
  overflow-y: auto;
  text-align: left !important; /* Links ausgerichtet statt Blocksatz */
  word-wrap: break-word !important; /* Wortumbruch */
  line-height: 1.4 !important; /* Zeilenabstand */
  flex: 1 1 0; /* Auch mono nutzt vollen Platz */
}

/* CSS-Regel entfernt - JavaScript übernimmt die Logik */

/* Alle speziellen Regeln entfernt - jetzt nur noch die einfache Lösung */

/* Standard-Verhalten für alle Text-Fenster - keine speziellen Höhen */

/* Spezielle Lösung für das Birkenbihl-Fenster - ENTFERNT */

/* Alternative Lösung ohne :has() - ENTFERNT */

/* SUPER EINFACHE LÖSUNG: Beide unteren Text-Fenster gleich groß machen */
#birkenbihlText,
#draftText {
  height: 800px !important;
  max-height: 800px !important;
  min-height: 800px !important;
  overflow-y: auto !important;
  display: block !important;
  flex: none !important;
}

/* Alle grünen Buttons im Entwurf-Fenster gleich groß und unterstrichen */
#draftFileLabel,
#btnDraftDownload,
#btnRenderDraft {
  min-width: 180px !important;
  height: 34px !important;
  font-size: 14px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-decoration: underline !important;
}

/* Entwurf zurücksetzen Button gleich groß - nochmal 2% kleiner */
#resetDraft {
  min-width: 160px !important;
  height: 34px !important;
  font-size: 13px !important; /* 13.3px * 0.98 = 13.0px */
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* EINFACHE REGEL: Alle Buttons in einer Zeile */
.pane-tools {
  display: flex !important;
  flex-wrap: nowrap !important;
  gap: 4px !important;
  align-items: center !important;
  overflow-x: auto !important;
}

/* Toggle-Buttons mit Button-Look für Header-Zeile - URSPRÜNGLICHE GRÖSSE */
.toggle-btn {
  display: inline-flex !important;
  align-items: center !important;
  gap: 2px !important;
  padding: 6px 10px !important; /* Ursprüngliche Größe */
  height: 34px !important; /* Ursprüngliche Größe */
  font-size: 14.5px !important; /* Ursprüngliche Größe */
  white-space: nowrap !important;
  border: 1px solid #d1d5db !important;
  background: #ffffff !important;
  border-radius: 8px !important; /* Ursprüngliche Größe */
  cursor: pointer !important;
  transition: all 0.2s ease !important;
}

/* PDF-Option-Buttons - URSPRÜNGLICHE GRÖSSE */
.pdf-option-btn {
  padding: 4.5px 9px !important; /* Ursprüngliche Größe */
  border: 1px solid var(--edge, #e5e7eb) !important;
  background: #fff !important;
  color: var(--muted, #6b7280) !important;
  border-radius: 6.75px !important; /* Ursprüngliche Größe */
  cursor: pointer !important;
  font-size: 13.5px !important; /* Ursprüngliche Größe */
  height: 34px !important; /* Ursprüngliche Größe */
  transition: all 0.2s ease !important;
}

/* SPEZIFISCHE GRÖSSEN FÜR RENDERING-MODAL - Toggle-Buttons */
#renderingModal .toggle-btn {
  padding: 7.2px 12px !important; /* 20% größer: 6px → 7.2px, 10px → 12px */
  height: 40.8px !important; /* 20% größer: 34px → 40.8px */
  font-size: 17.4px !important; /* 20% größer: 14.5px → 17.4px */
  border-radius: 9.6px !important; /* 20% größer: 8px → 9.6px */
}

/* SPEZIFISCHE GRÖSSEN FÜR RENDERING-MODAL - PDF-Option-Buttons */
#renderingModal .pdf-option-btn {
  padding: 8px 16px !important; /* Deutlich größer: 4.5px → 8px, 9px → 16px */
  border-radius: 10px !important; /* Größer: 6.75px → 10px */
  font-size: 16px !important; /* Größer: 13.5px → 16px */
  height: 44px !important; /* Größer: 34px → 44px */
}

/* SPEZIFISCHE GRÖSSEN FÜR KLEINE TABELLEN - Alle Buttons in der Tag-Konfigurationstabelle */
.tag-group-table button,
.tag-group-table .btn,
.tag-group-table input[type="checkbox"] {
  padding: 4px 8px !important; /* Normale Größe */
  font-size: 13px !important; /* Normale Größe */
  height: 28px !important; /* Normale Größe */
  border-radius: 6px !important; /* Normale Größe */
  min-width: 28px !important; /* Normale Mindestbreite */
}

/* Checkboxen speziell anpassen für kleine Tabellen */
.tag-group-table input[type="checkbox"] {
  width: 16px !important;
  height: 16px !important;
  margin: 0 auto !important;
}

/* Tabellenzeilen - ursprüngliche Größe für kleine Tabellen */
.tag-group-table tbody tr td {
  padding: 6px 12px !important; /* Ursprüngliche Größe */
  vertical-align: middle !important;
  height: auto !important; /* Automatische Höhe */
}

.toggle-btn:hover {
  background-color: #f9fafb !important;
  border-color: #9ca3af !important;
}

.toggle-btn .toggle-text {
  margin-right: 2px !important;
  padding: 0 !important;
}

.toggle-btn .toggle-status {
  margin-left: 2px !important;
  padding: 0 !important;
  font-weight: bold !important;
}

/* A+ und A- Buttons genauso groß wie die anderen - nochmal 2% kleiner */
.btn[id*="Plus"],
.btn[id*="Minus"] {
  padding: 6px 10px !important;
  min-width: auto !important;
  height: 34px !important;
  font-size: 14.5px !important; /* 14.8px * 0.98 = 14.5px */
  border: 1px solid #d1d5db !important;
  background: #ffffff !important;
  border-radius: 8px !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  margin: 0 1px !important; /* Noch engere Abstände */
}

/* Metrum-Marker ausblenden - funktioniert wie tags-hidden */
.metrum-hidden i,
.metrum-hidden L,
.metrum-hidden r {
  color: transparent !important;
  text-shadow: none !important;
  visibility: hidden !important;
}

/* Pipe-Character speziell behandeln */
.metrum-hidden[data-pipe] {
  color: transparent !important;
  visibility: hidden !important;
}

/* Für griechischen Text - alle Metrum-Marker verstecken */
.metrum-hidden {
  color: inherit !important;
}

/* Fallback: Alle i, L, r, | Zeichen verstecken wenn Metrum-Marker aus */
.metrum-hidden {
  font-feature-settings: normal !important;
}

/* ======= Segmented Controls ======= */
.option-groups {
  padding: 10px 12px 0;
  border-bottom: 1px solid var(--edge, #e5e7eb);
}
.opt-row {
  display: grid;
  grid-template-columns: 120px 1fr;
  gap: 8px;
  align-items: center;
  margin-bottom: 10px;
}
.opt-label {
  font-weight: 600;
}
.seg {
  display: inline-flex;
  gap: 6px;
  flex-wrap: wrap;
}
.seg-btn {
  border: 1px solid var(--edge, #e5e7eb);
  background: #fff;
  border-radius: 8px;
  padding: 6px 10px;
  cursor: pointer;
}
.seg-btn.active {
  background: #0b5;
  color: #fff;
  border-color: #0b5;
}

/* ======= Buttons/Inputs ======= */
.btn {
  border: 1px solid var(--edge, #e5e7eb);
  background: #fff;
  border-radius: 8px;
  padding: 6px 10px;
  cursor: pointer;
}
.btn.primary {
  background: #0b5;
  color: #fff;
  border-color: #0b5;
}
.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ======= Modal Button Größen ======= */
/* Schließen-Button (×) 17% größer (20% - 3%) */
#closeModal,
#closeResetModal {
  font-size: 1.17em !important; /* 17% größer */
  padding: 6.84px 11.4px !important; /* 17% größer */
  height: 38.76px !important; /* 17% größer */
  width: 38.76px !important; /* 17% größer */
  border-radius: 9.12px !important; /* 17% größer */
}

/* PDFs erstellen Button 14% größer (20% - 6%) */
#confirmRendering {
  padding: 6.72px 11.2px !important; /* 14% größer */
  height: 38.16px !important; /* 14% größer */
  font-size: 1.14em !important; /* 14% größer */
  border-radius: 8.96px !important; /* 14% größer */
}

/* Abbrechen Button 14% größer (20% - 6%) */
#cancelRendering,
#cancelReset {
  padding: 6.72px 11.2px !important; /* 14% größer */
  height: 38.16px !important; /* 14% größer */
  font-size: 1.14em !important; /* 14% größer */
  border-radius: 8.96px !important; /* 14% größer */
}
.draft-uploader {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px;
  background: #f9fafb;
}
#draftFileLabel {
  background-color: #22c55e; /* Selbes Grün wie die anderen Buttons */
  color: white;
  cursor: pointer;
}
#draftFileLabel:hover {
  background-color: #16a34a;
}

.muted {
  color: var(--muted, #666);
  font-size: 13px;
}

/* ======= Modal ======= */
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 0;
  border: 1px solid #888;
  width: auto;
  max-width: 85%;
  border-radius: 8px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
}

.modal-content.confirmation-modal {
  max-width: 500px;
}

.modal-header {
  padding: 16px 24px;
  border-bottom: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h2 {
  margin: 0;
  font-size: 1.5em; /* 20% größer */
}

.header-controls {
  display: flex;
  gap: 16px;
  align-items: center;
}

.header-controls .btn {
  font-size: 1em; /* 20% größer */
  padding: 8px 14px;
}

.modal-body {
  padding: 16px;
  max-height: 70vh;
  overflow-y: auto;
}

.modal-footer {
  padding: 12px 16px;
  border-top: 1px solid #e5e7eb;
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  background: #f9fafb;
}

.config-section h3 {
  margin-top: 0;
  margin-bottom: 15px;
  color: #374151;
  font-size: 1.4em; /* 20% größer */
}

/* Quick Controls */
.quick-controls {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e5e7eb;
}

.color-quick-controls {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.general-controls {
  display: flex;
  gap: 12px;
}

/* ERZWINGE EINZEILIGES LAYOUT für alle Buttons in pane-tools */
.pane-head:nth-child(2) .pane-tools,
.pane-head:nth-child(2) .pane-tools * {
  display: inline-flex !important;
  align-items: center !important;
  white-space: nowrap !important;
  flex-shrink: 0 !important;
  vertical-align: middle !important;
  float: none !important;
  clear: none !important;
}

.pane-head:nth-child(2) .pane-tools {
  display: flex !important;
  flex-wrap: nowrap !important;
  gap: 4px !important;
  overflow-x: auto !important;
  justify-content: flex-start !important;
}

/* Zweite Header-Zeile - ALLE Buttons in EINER Zeile linksbündig */
.pane-head:nth-child(2) .pane-tools {
  display: flex !important;
  flex-wrap: nowrap !important;
  gap: 6px !important;
  align-items: center !important;
  overflow-x: auto !important;
  justify-content: flex-start !important;
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
}

.pane-head:nth-child(2) .pane-tools #resetDraft {
  margin-left: auto !important;
}

/* ALLE Buttons ohne Unterstreichung - STÄRKSTE REGEL */
html body .pane-head .btn,
html body .pane-head .toggle-btn,
html body .pane-head button,
html body .pane-head .btn.primary {
  text-decoration: none !important;
}

.pane-head:first-child .btn.primary {
  text-decoration: none !important;
}

/* ERSTE Header-Zeile Buttons ohne Unterstreichung - STÄRKSTE REGEL */
html body .pane-head:first-child .btn.primary {
  text-decoration: none !important;
}

/* PDF aus Entwurf erstellen Button - dunkleres Grün für Hervorhebung - 5% kleiner */
.pane-head:first-child #btnRenderDraft {
  background: #059669 !important; /* Gleicher Grünton wie andere Buttons */
  border-color: #059669 !important;
  min-width: 160px !important;
  height: 34px !important;
  font-size: 13.3px !important; /* 14px * 0.95 = 13.3px */
  padding: 6px 14px !important;
  border-radius: 8px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-decoration: none !important;
}

/* Alle anderen Buttons in erster Header-Zeile - gleiche Größe - 5% kleiner */
.pane-head:first-child #draftFileLabel,
.pane-head:first-child #btnDraftDownload {
  min-width: 160px !important;
  height: 34px !important;
  font-size: 13.3px !important; /* 14px * 0.95 = 13.3px */
  padding: 6px 14px !important;
  border-radius: 8px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-decoration: none !important;
}

/* Alle Download-Buttons gleiche Größe wie PDF aus Entwurf erstellen - 5% kleiner */
#btnBirkenbihlDownload,
#btnOrigDownload,
#btnPdfDownload,
#btnPdfOpenTab,
#pdfOpenTabBtn,
#pdfDownloadBtn {
  min-width: 160px !important;
  height: 34px !important;
  font-size: 13.3px !important; /* 14px * 0.95 = 13.3px */
  padding: 6px 14px !important;
  border-radius: 8px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  text-decoration: none !important;
}

.pane-head:nth-child(2) #resetDraft {
  text-decoration: none !important;
  background: #0b5 !important; /* Gleicher Grünton wie andere grüne Buttons */
  color: #ffffff !important;
  border-color: #0b5 !important;
}

/* Toggle-Button Hover-Effekte für Header-Zeile */
.toggle-btn:hover {
  background-color: #f3f4f6 !important;
  border-radius: 4px !important;
}

.toggle-status {
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
}

.toggle-status.green {
  color: #16a34a;
}
.toggle-status.red {
  color: #dc2626;
}

.tag-table-container {
  width: 100%;
}

/* Container für mehrere kleine Tabellen */
#tag-config-tables {
  display: flex;
  flex-direction: column;
  gap: 20px; /* Abstand zwischen den kleinen Tabellen */
}

/* Kleine Gruppentabellen - gleiches Styling wie die große Tabelle */
.tag-group-table {
  width: 100%;
  border-collapse: separate; /* Separate für runde Ecken */
  border-spacing: 0;
  table-layout: fixed;
  border-radius: 12px;
  overflow: hidden;
  border: 2px solid #000000;
}

/* Header für kleine Tabellen */
.tag-group-table thead {
  text-align: center;
  border: 2px solid #000000; /* Schwarzer Rahmen um die Kopfzeile */
  border-radius: 8px;
  background: #fff;
  margin-bottom: 0.5em; /* Abstand zur Tabelle */
}

.tag-group-table th:last-child {
  text-align: center;
}

/* Fette Linien zwischen bestimmten Spalten für kleine Tabellen */
.tag-group-table th:nth-child(1),
.tag-group-table td:nth-child(1) {
  border-right: 2px solid #000000 !important; /* Fette Linie nach Modifikation */
}

.tag-group-table th:nth-child(3),
.tag-group-table td:nth-child(3) {
  border-right: 2px solid #000000 !important; /* Fette Linie nach tiefgestellt */
}

.tag-group-table th:nth-child(8),
.tag-group-table td:nth-child(8) {
  border-right: 2px solid #000000 !important; /* Fette Linie nach magenta */
}

.tag-group-table th,
.tag-group-table td {
  border: 1px solid #e5e7eb; /* Ursprüngliche dünne Borders für alle Zellen */
  padding: 6px 10px;
  text-align: center; /* Zentriert für alle Zellen */
  background: #ffffff; /* Weiße Hintergrundfarbe */
  white-space: normal;
  word-break: break-word;
  line-height: 1.2;
}

/* Erste Spalte (Modifikation) breiter machen und linksbündig für kleine Tabellen */
.tag-group-table th:first-child,
.tag-group-table td:first-child {
  width: 25%; /* Mehr Platz für die Modifikationsnamen */
  min-width: 150px; /* Mindestbreite */
  white-space: nowrap; /* Verhindert Zeilenumbrüche */
  text-align: left; /* Linksbündig für Modifikationsnamen */
}

/* Tbody für kleine Tabellen */
.tag-group-table tbody {
  border: none; /* Kein separater Rahmen, da die Tabelle bereits einen hat */
  border-radius: 0; /* Keine runden Ecken für tbody */
  background: #fff;
  margin-bottom: 0.5em; /* Abstand zwischen Gruppen */
}

/* Gruppenleiter für kleine Tabellen */
.tag-group-table .group-leader td {
  background-color: #ffffff; /* Weiße Hintergrundfarbe für Gruppenleiter */
  font-weight: bold; /* Fett für Gruppenleiter */
  font-size: 1.2em; /* Größer für Gruppenleiter */
  border: 1px solid #e5e7eb; /* Normale Borders für alle Seiten */
  border-bottom: 2px solid #000000 !important; /* Dickere schwarze Linie unter Gruppenleiter */
}

/* Separator für kleine Tabellen (sollten nicht mehr benötigt werden) */
.tag-group-table .group-separator td {
  padding: 0;
  height: 0;
  border: none;
  background-color: transparent;
  display: none;
}

/* Zeilen innerhalb einer Gruppe für kleine Tabellen */
.tag-group-table tbody tr {
  margin: 0;
  padding: 0;
}

/* Keine horizontalen Borders zwischen Zeilen innerhalb einer Gruppe für kleine Tabellen */
.tag-group-table tbody tr td {
  border-top: none !important;
  border-bottom: none !important;
  vertical-align: middle;
  padding: 6px 12px;
}

/* Nur die erste Zeile einer Gruppe hat einen oberen Border für kleine Tabellen */
.tag-group-table tbody tr:first-child td {
  border-top: 1px solid #e5e7eb !important;
}

/* Nur die letzte Zeile einer Gruppe hat einen unteren Border für kleine Tabellen */
.tag-group-table tbody tr:last-child td {
  border-bottom: 1px solid #e5e7eb !important;
}

/* Farb-Hintergründe werden jetzt über JavaScript gesetzt */

/* JavaScript-Hintergrundfarben für Zeilen - deaktiviert, da wir jetzt inline-Styles verwenden */

/* Gruppen-spezifische Styling entfernt - wird durch tbody-Border ersetzt */

.config-hint {
  margin-top: 24px;
  font-size: 0.9em;
  color: #4b5563;
  line-height: 1.5;
}

/* Zeilenhintergrundfarben */
.color-bg-red {
  background-color: rgba(239, 68, 68, 0.15) !important;
}
.color-bg-orange {
  background-color: rgba(249, 115, 22, 0.15) !important;
}
.color-bg-blue {
  background-color: rgba(59, 130, 246, 0.15) !important;
}
.color-bg-green {
  background-color: rgba(34, 197, 94, 0.15) !important;
}
.color-bg-violett {
  background-color: rgba(147, 112, 219, 0.15) !important; /* Medium Purple */
}

/* Color Checkboxes */
.color-checkbox {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-weight: 500;
  font-size: 14px;
}

.color-checkbox input[type="checkbox"] {
  display: none;
}

.checkmark {
  width: 20px;
  height: 20px;
  border: 2px solid #d1d5db;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  transition: all 0.2s;
}

.checkmark::after {
  content: "✓";
  color: white;
  font-weight: bold;
  font-size: 12px;
  opacity: 0;
  transition: opacity 0.2s;
}

.color-checkbox input:checked + .checkmark::after {
  opacity: 1;
}

.color-checkbox.blue input:checked + .checkmark {
  background: #3b82f6;
  border-color: #3b82f6;
}

.color-checkbox.blue input:checked ~ span:not(.checkmark) {
  color: #3b82f6;
}

.color-checkbox.green input:checked + .checkmark {
  background: #10b981;
  border-color: #10b981;
}

.color-checkbox.green input:checked ~ span:not(.checkmark) {
  color: #10b981;
}

.color-checkbox.red input:checked + .checkmark {
  background: #ef4444;
  border-color: #ef4444;
}

.color-checkbox.red input:checked ~ span:not(.checkmark) {
  color: #ef4444;
}

/* Tag Controls */
.tag-controls {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin-bottom: 20px;
}

.group-header {
  margin-bottom: 15px;
}

.placement-header {
  display: grid;
  grid-template-columns: 120px 1fr 1fr 1fr 1fr 1fr 1fr; /* 7 Spalten: Tag (120px) + hoch-gestellt + tief-gestellt + rot + blau + grün + Tag verstecken */
  gap: 8px;
  margin-bottom: 10px;
  text-align: center;
  margin-left: 0; /* Entferne margin-left um Header zu zentrieren */
  padding: 0 12px; /* Gleiche Padding wie bei .tag-checkbox */
}

.tag-placeholder {
  font-size: 11px;
  color: #f8fafc; /* Gleiche Farbe wie Hintergrund der .tag-checkbox */
  font-weight: 500;
  padding: 4px 2px;
  text-align: center;
}

.placement-label,
.color-label,
.hide-label {
  font-size: 11px;
  color: #6b7280;
  font-weight: 500;
  padding: 4px 2px;
}

.color-label {
  font-weight: 600;
}

.color-label:nth-child(4) {
  color: #ef4444;
} /* rot */
.color-label:nth-child(5) {
  color: #3b82f6;
} /* blau */
.color-label:nth-child(6) {
  color: #10b981;
} /* grün */

.hide-label {
  font-size: 10px;
  line-height: 1.2;
}

.tag-checkboxes {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.tag-checkbox {
  display: grid;
  grid-template-columns: 120px 1fr 1fr 1fr 1fr 1fr 1fr; /* Feste Breite für Tag-Name + hoch-gestellt + tief-gestellt + rot + blau + grün + Tag verstecken */
  gap: 8px;
  align-items: center;
  padding: 8px 12px;
  border-radius: 6px;
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  font-size: 13px;
  transition: all 0.2s;
}

.tag-checkbox:hover {
  background: #f1f5f9;
  border-color: #cbd5e1;
}

.tag-checkbox input[type="checkbox"],
.tag-checkbox input[type="radio"] {
  margin: 0;
  width: 16px;
  height: 16px;
  justify-self: center;
}

.tag-checkbox label {
  margin: 0;
  cursor: pointer;
  font-weight: 500;
  text-align: center;
  font-size: 12px;
}

.tag-name {
  font-weight: bold;
  color: #374151;
  text-align: left;
}

/* Placement Controls */
.placement-controls {
  display: flex;
  gap: 15px;
  align-items: center;
  margin-left: 20px;
}

.placement-controls input[type="radio"] {
  margin: 0;
  width: 16px;
  height: 16px;
}

.placement-controls label {
  margin: 0;
  cursor: pointer;
  font-size: 12px;
  color: #6b7280;
}

/* Color Controls */
.color-controls {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-left: 20px;
}

.color-controls input[type="checkbox"] {
  margin: 0;
  width: 16px;
  height: 16px;
}

.color-controls label {
  margin: 0;
  cursor: pointer;
  font-size: 12px;
  color: #6b7280;
}

/* Hide Controls */
.hide-control {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-left: 20px;
}

.hide-control input[type="checkbox"] {
  margin: 0;
  width: 16px;
  height: 16px;
}

.hide-control label {
  margin: 0;
  cursor: pointer;
  font-size: 12px;
  color: #6b7280;
}

.quick-controls .btn {
  font-size: 12px;
  padding: 6px 12px;
}

.complex-header {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 8px 12px; /* Reduziertes Padding für kompakteren Header */
}
.header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  /* Wrapper für linksbündige Elemente, damit space-between funktioniert */
}
.header-row > button {
  flex-shrink: 0;
}
.header-separator {
  height: 1px;
  background-color: #e5e7eb;
  width: 100%;
}
.display-controls,
.file-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

/* ======= Responsiv ======= */
@media (max-width: 900px) {
  .grid-2x2 {
    grid-template-columns: 1fr;
  }
  .pane {
    min-height: 760px; /* auf kleineren Screens weiterhin deutlich höher */
  }

  .tag-controls {
    grid-template-columns: 1fr;
  }

  .modal-content {
    width: 95%;
    max-height: 95vh;
  }
}

/* PDF-Renderer direkt im PDF-Fenster */
.pdf-renderer-container {
  height: 100%;
  min-height: 100%; /* Mindesthöhe für vollständige Darstellung */
  display: flex;
  flex-direction: column;
  background: transparent; /* Kein grauer Hintergrund mehr */
  position: relative;
  z-index: 1; /* Niedrigere Priorität als Topbar */
  overflow: visible; /* Kein Abschneiden */
}

/* PDF-Optionen-Buttons (integriert) */
.pdf-options-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 12px;
  padding: 8px;
  background: var(--paper, #ffffff);
  border: 1px solid var(--edge, #e5e7eb);
  border-radius: 8px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
}

.pdf-options-group {
  display: flex;
  background: #f3f4f6;
  border-radius: 6px;
  padding: 3px;
  gap: 2px;
}

.dark-theme .pdf-options-group,
.dark-mode .pdf-options-group {
  background: #4b5563;
}

.pdf-option-btn {
  padding: 4.52px 9.03px; /* Nochmal 0.5% größer: 4.5px → 4.52px, 8.99px → 9.03px */
  border: 1px solid var(--edge, #e5e7eb);
  background: #fff;
  color: var(--muted, #6b7280);
  border-radius: 6.77px; /* Nochmal 0.5% größer: 6.74px → 6.77px */
  cursor: pointer;
  font-size: 13.56px; /* Nochmal 0.5% größer: 13.49px → 13.56px */
  height: 33.91px; /* Nochmal 0.5% größer: 33.74px → 33.91px */
  transition: all 0.2s ease;
}

.pdf-option-btn:hover {
  background: #e5e7eb;
  color: var(--ink, #111);
}

.dark-theme .pdf-option-btn:hover,
.dark-mode .pdf-option-btn:hover {
  background: #6b7280;
}

.pdf-option-btn.active {
  background: #0b5 !important;
  color: white !important;
  font-weight: 500 !important;
}

/* Original/Entwurf Buttons (data-opt="source") - nur aktiver Button grün */
/* Inaktive Buttons: normale graue Farbe */
button.pdf-option-btn[data-opt="source"],
.pdf-toolbar button.pdf-option-btn[data-opt="source"],
.pdf-options-group button.pdf-option-btn[data-opt="source"] {
  background: #f3f4f6 !important;
  background-color: #f3f4f6 !important;
  color: #374151 !important;
  border-color: #d1d5db !important;
}

button.pdf-option-btn[data-opt="source"]:hover,
.pdf-toolbar button.pdf-option-btn[data-opt="source"]:hover {
  background: #e5e7eb !important;
  background-color: #e5e7eb !important;
  border-color: #9ca3af !important;
}

/* Aktiver Button: Helleres Grün wie "PDF aus Entwurf erstellen" (#059669) */
button.pdf-option-btn[data-opt="source"].active,
.pdf-toolbar button.pdf-option-btn[data-opt="source"].active,
.pdf-options-group button.pdf-option-btn[data-opt="source"].active {
  background: #059669 !important;
  background-color: #059669 !important;
  color: white !important;
  border-color: #059669 !important;
  font-weight: 600 !important;
  box-shadow: none !important; /* Kein Leucht-Effekt */
}

/* PDF-Toolbar im PDF-Fenster */
.pdf-toolbar {
  position: sticky;
  top: 0;
  z-index: 5; /* Niedrigere Priorität als Topbar */
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px 12px;
  margin-bottom: 8px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(6px);
  border: 1px solid var(--edge, #e5e7eb);
  border-radius: 8px;
}

.pdf-toolbar-row {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: 12px !important;
}

/* Navigation-Zeile: Seite links, Zoom Mitte, Source rechts */
.pdf-nav-row {
  justify-content: space-between !important;
}

.pdf-nav-left {
  display: flex !important;
  gap: 6px !important;
  align-items: center !important;
}

/* PDF-Navigation Seitenanzeige - ursprüngliche Größe beibehalten */

/* Original/Entwurf-Button an Seitenzahl-Anzeige anpassen */
.pdf-source-controls .pdf-options-group {
  display: flex !important;
  gap: 2px !important;
  align-items: center !important;
}

.pdf-source-controls .pdf-option-btn {
  padding: 6px 12px !important; /* Größer als normale PDF-Optionen */
  font-size: 14px !important; /* Größer als normale PDF-Optionen */
  height: 34px !important; /* Höher als normale PDF-Optionen */
  font-weight: 500 !important;
  min-width: 80px !important; /* Mindestbreite für bessere Lesbarkeit */
}

.pdf-source-controls {
  display: flex !important;
  gap: 6px !important;
  align-items: center !important;
}

.pdf-options-row {
  justify-content: flex-start !important; /* Linksbündig statt zentriert */
  padding-top: 0 !important; /* Kein Padding, da nur noch eine Zeile */
  border-top: none !important; /* Keine Trennlinie mehr */
}

.dark-theme .pdf-toolbar,
.dark-mode .pdf-toolbar {
  background: rgba(55, 65, 81, 0.9);
}

.pdf-toolbar .left,
.pdf-toolbar .right {
  display: flex !important;
  gap: 6px !important;
  align-items: center !important;
  flex-wrap: wrap !important;
}

/* .center entfernt - nicht mehr benötigt */

.pdf-toolbar .right {
  gap: 8px;
}

.pdf-toolbar .btn,
.pdf-toolbar .toggle {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid var(--edge, #e5e7eb);
  background: var(--paper, #ffffff);
  color: var(--ink, #111);
  cursor: pointer;
  user-select: none;
  font-size: 14px;
  height: 34px;
}

.pdf-toolbar .btn:active {
  transform: translateY(1px);
}

.pdf-toolbar .toggle[aria-pressed="true"] {
  border-color: var(--accent, #0a84ff);
  box-shadow: 0 0 0 2px rgba(10, 132, 255, 0.15);
}

.pdf-toolbar .btn.primary {
  background: #0b5;
  color: white;
  border-color: #0b5;
}

.pdf-toolbar .sep {
  width: 1px;
  height: 20px;
  background: var(--edge, #e5e7eb);
}

/* PDF-Optionen integriert in Toolbar */
.pdf-options-integrated {
  display: flex !important;
  gap: 12px !important;
  align-items: center !important;
  flex-wrap: wrap !important;
  justify-content: flex-start !important; /* Linksbündig statt zentriert */
}

.pdf-options-integrated .pdf-options-group {
  display: flex;
  gap: 2px;
  align-items: center;
}

/* Versmaß-Button-Gruppe wird durch JavaScript gesteuert */

/* Metrum-Marker Buttons werden durch JavaScript gesteuert */

.pdf-options-integrated .pdf-option-btn {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4.5px 9px; /* Ursprüngliche Größe */
  border-radius: 6.75px; /* Ursprüngliche Größe */
  border: 1px solid var(--edge, #e5e7eb);
  background: var(--paper, #ffffff);
  color: var(--ink, #111);
  cursor: pointer;
  user-select: none;
  font-size: 13.5px; /* Ursprüngliche Größe */
  height: 34px; /* Ursprüngliche Größe */
  transition: all 0.2s ease;
}

.pdf-options-integrated .pdf-option-btn:hover {
  background: var(--bg, #f6f7f9);
}

.pdf-options-integrated .pdf-option-btn.active {
  background: #0b5 !important;
  color: white !important;
  border-color: #0b5 !important;
}

/* PDF-Seiten im PDF-Fenster */
.pdf-pages {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 20px;
  overflow-y: auto;
  max-height: none; /* Keine Höhenbegrenzung mehr */
  min-height: 100%; /* Mindesthöhe für vollständige Darstellung */
  padding: 0; /* Kein Padding mehr - PDF soll bis zum Rand gehen */
  align-items: stretch; /* Stretch statt center für volle Breite */
  background: transparent; /* Kein grauer Hintergrund */
}

.pdf-page {
  display: flex;
  flex-direction: column;
  align-items: stretch; /* Stretch statt center für volle Breite */
  background: transparent; /* Kein weißer Hintergrund mehr */
  border-radius: 0; /* Keine abgerundeten Ecken */
  box-shadow: none; /* Kein Schatten mehr */
  padding: 0; /* Kein Padding mehr */
  overflow: visible;
  margin: 0; /* Kein Margin mehr */
  width: 100% !important; /* Volle Breite nutzen */
  max-width: 100% !important; /* Nicht größer als Container */
  min-width: 100% !important; /* Mindestbreite für volle Ausnutzung */
}

.dark-theme .pdf-page,
.dark-mode .pdf-page {
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
}

.pdf-page canvas {
  display: block;
  width: 100% !important; /* Volle Breite des Containers nutzen */
  height: auto !important;
  border-radius: 0; /* Keine abgerundeten Ecken */
  max-width: 100% !important;
  min-width: 100% !important; /* Mindestbreite für volle Ausnutzung */
  box-shadow: none; /* Kein Schatten mehr */
  image-rendering: -webkit-optimize-contrast; /* Bessere Schärfe */
  image-rendering: crisp-edges; /* Scharfe Kanten */
  image-rendering: pixelated; /* Pixel-perfect Rendering */
  image-rendering: high-quality; /* Höchste Qualität */
  image-rendering: auto; /* Fallback */
  /* Zusätzliche Schärfe-Eigenschaften */
  -webkit-font-smoothing: none; /* Keine Glättung für schärfere Kanten */
  -moz-osx-font-smoothing: unset; /* Keine Glättung auf macOS */
  text-rendering: optimizeSpeed; /* Schnelle, scharfe Darstellung */
  transform: translateZ(0); /* Hardware-Beschleunigung */
  backface-visibility: hidden; /* Bessere Rendering-Performance */
  -webkit-font-smoothing: antialiased; /* Bessere Text-Schärfe */
  -moz-osx-font-smoothing: grayscale; /* Bessere Text-Schärfe auf macOS */
  margin-bottom: 0; /* Kein Margin am Ende */
  padding-bottom: 0; /* Kein Padding am Ende */
}

.pdf-page-num {
  text-align: center;
  color: #000000 !important; /* Schwarz statt grau */
  font-size: 12px !important; /* 40% kleiner: 20px → 12px */
  font-weight: 600 !important; /* Fetter für bessere Lesbarkeit */
  margin-top: 6px !important; /* Weniger Abstand */
}

/* Lade-Animation */
.pdf-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 150px;
  color: var(--muted, #6b7280);
}

.pdf-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid var(--edge, #e5e7eb);
  border-top: 2px solid var(--accent, #0a84ff);
  border-radius: 50%;
  animation: pdf-spin 1s linear infinite;
  margin-right: 6px;
}

@keyframes pdf-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* Responsive Anpassungen für PDF-Fenster */
@media (max-width: 640px) {
  .pdf-renderer-container .opt-row {
    flex-direction: column;
    align-items: flex-start;
  }
  .pdf-renderer-container .opt-label {
    min-width: auto;
  }
  .pdf-renderer-container .seg-btn {
    font-size: 11px;
    padding: 5px 10px;
  }
}
